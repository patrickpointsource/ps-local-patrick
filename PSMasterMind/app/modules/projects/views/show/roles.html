<div ng-form="rolesForm" ng-controller="RolesCtrl">
	<div class="row">
		<div class="col-xs-8"><h3>Roles</h3></div>
		<div class="actions col-xs-4 pageActions">
			<button type="button"
				ng-click="triggerAddRole()"
				data-toggle="collapse" data-target="#newRoleDialog"
				class="btn btn-default pull-right">
		  		<i class="fa fa-plus-square"></i> <span>Add Roles</span>
			</button>
		</div>
	</div>
	<div id="messages" class="alert alert-danger" ng-show="addRoleMessages.length > 0">
       <!--  <a class="close" ng-click="addRoleMessages = []">&times;</a> -->
        <ul>
            <li ng-repeat="message in addRoleMessages">{{message}}</li>
        </ul>
    </div>
	<section id="newRoleDialog" class="well collapse out">
        <ng-include src="'modules/projects/views/show/editRole.html'"/>
    </section>
    
	<!-- button ng-click="roleTableParams.reload()" class="btn btn-default">Reload</button-->
    <div class="row">
        <div class="col-xs-12">
            <table class="table" ng-table="roleTableParams" template-pagination="custom/pager">
              <thead>
                <tr>
                  
                  <th class="hidden-xs">Role</th>
                  <th>Hours</th>
                  <th class="hidden-xs">Start Date</th>
                  <th class="hidden-xs">End Date</th>
                  <th class="visible-xs">Dates</th>
                  <th></th>
                </tr>
              </thead>
              <tbody ng-repeat="role in $data">
                <tr>
                    <td>
                    	<!-- 
                        <select ng-model="role.assignee.resource"
                                ng-options="m.resource as m.title for m in roleGroups[role.type.resource].assiganble"
                                ng-change="assigneeChanged($index, role)"
                                class="form-control">
                        </select>
                         -->
                        <span>{{roleGroups[role.type.resource].abbreviation}}</span>
                    </td>
                    <!-- <td class="hidden-xs">{{roleGroups[role.type.resource].abbreviation}}</td> -->
                    <td class="visible-xs">
                      <span ng-show="role.rate.isFullyUtilized()">100%</span>
                      <span ng-hide="role.rate.isFullyUtilized()">{{role.rate.hoursPerMonth()}}/M</span>
                    </td>
                    <td class="hidden-xs">
                    	<span>{{displayHours(role)}}</span>
                    </td>
                    <td class="hidden-xs">{{role.startDate | date:'longDate'}}</td>
                    <td class="hidden-xs">{{role.endDate | date:'longDate'}}</td>
                    <td class="visible-xs">
                      <small>{{role.startDate | date:'shortDate'}}</small>
                      <span ng-show="role.endDate">-<br><small>{{role.endDate | date:'shortDate'}}</small></span>
                      <span ng-hide="role.endDate">- N/A</span>
                    </td>
                    <td class="actionsCell">
                        <button class="btn btn-default" ng-click="triggerEditRole(role, $index)">
                            <i class="fa fa-pencil"></i>
                        </button>
                        <button class="btn btn-default" ng-click="triggerDuplicateRole(role, $index)">
                            <i class="fa fa-files-o"></i>
                        </button>
                        <button class="btn btn-default" ng-click="remove(role)">
                            <i class="fa fa-trash-o"></i>
                        </button>
                    </td>
                </tr>
                <tr ng-show="editRoleIndex===$index" ng-if="editRoleIndex===$index">
	             	<td colspan="5">
	             		<div ng-form="newRoleForm{{$index}}" id="editRoleDialog{{$index}}" class="well">
						    <ng-include src="'modules/projects/views/show/editRole.html'"/>
						</div>
	             	</td>
	             </tr>
              </tbody>
            </table>
            <script type="text/ng-template" id="custom/pager">
                <ul class="pager ng-cloak">
                    <li ng-repeat="page in pages"
                            ng-class="{'disabled': !page.active, 'previous': page.type == 'prev', 'next': page.type == 'next'}"
                            ng-show="page.type == 'prev' || page.type == 'next'" ng-switch="page.type">
                        <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo; Previous</a>
                        <a ng-switch-when="next" ng-click="params.page(page.number)" href="">Next &raquo;</a>
                    </li>
                    <li>
                        <div class="btn-group" ng-show="page.type == 'prev' || page.type == 'next'">
                            <button type="button" ng-class="{'active':params.count() == 10}" ng-click="params.count(10)" class="btn btn-default">10</button>
                            <button type="button" ng-class="{'active':params.count() == 25}" ng-click="params.count(25)" class="btn btn-default">25</button>
                            <button type="button" ng-class="{'active':params.count() == 50}" ng-click="params.count(50)" class="btn btn-default">50</button>
                            <button type="button" ng-class="{'active':params.count() == 100}" ng-click="params.count(100)" class="btn btn-default">100</button>
                        </div>
                    </li>
                </ul>
            </script>
        </div>
    </div>
</div>
 <div class="row" ng-if="financeAccess">
	<br/>
    <div class="col-xs-12 " ng-if="isPaidClientProject()">
        <div class="row well">
   			<div class="col-xs-4">
                <label>Estimated value:</label> <span>(USD) {{(servicesEstimate+project.terms.softwareEstimate) | currency}}</span>
            </div>
            <div class="col-xs-4">
                <label>Total $ In Plan:</label> <span>{{servicesTotal() | currency}}</span>
            </div>
            <div class="col-xs-4">
                <label>Margin %:</label> <span>{{projectMargin() | number:0}}</span>
            </div>
        </div>
    </div>
     <br/>
</div>