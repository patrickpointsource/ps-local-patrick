<br />
<div id="content">
	<div class="row-fluid" ng-if="adminAccess && activeProjectsWithUnassignedPeople.length > 0">
	<div class="panel panel-danger dashboard-widget">
		<div class="panel-heading">Staffing Deficits: Active Projects
			<div class="pull-right  btn-group btn-group-sm dashboard-actions">
				  <a class="btn btn-default" ng-mousedown="activeDefToCSV.generate()" ng-href="{{activeDefToCSV.link()}}" download="ActiveDeficit.csv"> 
		      		<div class="hidden-xs"><i class="fa fa-table"></i><span> Export to CSV</span></div>
		      		<div class="visible-xs"><i class="fa fa-table"></i></div>
		    	  </a>
    	  	</div>
    	  </div>
		<table ng-table="unassignedRoleList" template-pagination="activeDeficit/pager" class="table margin-top" export-active="activeDefToCSV">
			<thead>
				<th class="text-center sortable" ng-class="{
                    'sort-asc': unassignedRoleList.isSortBy('title', 'asc'),
                    'sort-desc': unassignedRoleList.isSortBy('title', 'desc')
                  }"
                  ng-click="unassignedRoleList.sorting({'title' : unassignedRoleList.isSortBy('title', 'asc') ? 'desc' : 'asc'})">
                  <div>Project</div>
                </th>
                <th class="text-center sortable" ng-class="{
                    'sort-asc': unassignedRoleList.isSortBy('role', 'asc'),
                    'sort-desc': unassignedRoleList.isSortBy('role', 'desc')
                  }"
                  ng-click="unassignedRoleList.sorting({'role' : unassignedRoleList.isSortBy('role', 'asc') ? 'desc' : 'asc'})">
                  <div>Role</div>
                </th>
                <th class="text-center sortable" ng-class="{
                    'sort-asc': unassignedRoleList.isSortBy('hours', 'asc'),
                    'sort-desc': unassignedRoleList.isSortBy('hours', 'desc')
                  }"
                  ng-click="unassignedRoleList.sorting({'hours' : unassignedRoleList.isSortBy('hours', 'asc') ? 'desc' : 'asc'})">
                  <div>Hours</div>
                </th>
                <th class="hidden-xs text-center sortable" ng-class="{
                    'sort-asc': unassignedRoleList.isSortBy('startDate', 'asc'),
                    'sort-desc': unassignedRoleList.isSortBy('startDate', 'desc')
                  }"
                  ng-click="unassignedRoleList.sorting({'startDate' : unassignedRoleList.isSortBy('startDate', 'asc') ? 'desc' : 'asc'})">
                  <div>Start Date</div>
                </th>
                <th class="hidden-xs text-center sortable" ng-class="{
                    'sort-asc': unassignedRoleList.isSortBy('endDate', 'asc'),
                    'sort-desc': unassignedRoleList.isSortBy('endDate', 'desc')
                  }"
                  ng-click="unassignedRoleList.sorting({'endDate' : unassignedRoleList.isSortBy('endDate', 'asc') ? 'desc' : 'asc'})">
                  <div>End Date</div>
                </th>
                <th class="visible-xs text-center sortable" ng-class="{
                    'sort-asc': unassignedRoleList.isSortBy('startDate', 'asc'),
                    'sort-desc': unassignedRoleList.isSortBy('startDate', 'desc')
                  }"
                  ng-click="unassignedRoleList.sorting({'startDate' : unassignedRoleList.isSortBy('startDate', 'asc') ? 'desc' : 'asc'})">
                  <div>Dates</div>
                </th>
			</thead>
			<tbody>
				<tr ng-repeat="unassignedRole in $data">
					<td>
						<a href="#{{unassignedRole.projectResource}}">{{unassignedRole.title}}</a></td>
					<td data-title="'Role'">
						{{unassignedRole.role}}</td>
					<td data-title="'Hours'">
						{{unassignedRole.hours}}</td>
					<td class="hidden-xs">
						{{unassignedRole.startDate}}</td>
					<td class="hidden-xs">
						{{unassignedRole.endDate}}</td>
					<td class="visible-xs">
	                    <small>{{unassignedRole.startDate | date:'shortDate'}}</small>
	                    <span ng-show="unassignedRole.endDate">-<br><small>{{unassignedRole.endDate | date:'shortDate'}}</small></span>
	                    <span ng-hide="unassignedRole.endDate">- <small>N/A</small></span>
	                </td>
				</tr>
			</tbody>
		</table>
		<script type="text/ng-template" id="activeDeficit/pager">
            <ul class="pager ng-cloak">
              <li ng-repeat="page in pages"
                    ng-class="{'disabled': !page.active, 'previous': page.type == 'prev', 'next': page.type == 'next'}"
                    ng-show="page.type == 'prev' || page.type == 'next'" ng-switch="page.type">
                <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo; Previous</a>
                <a ng-switch-when="next" ng-click="params.page(page.number)" href="">Next &raquo;</a>
              </li>
                <li>
                <div class="btn-group" ng-show="page.type == 'prev' || page.type == 'next'">
                    <button type="button" ng-class="{'active':params.count() == 10}" ng-click="params.count(10)" class="btn btn-default">10</button>
                    <button type="button" ng-class="{'active':params.count() == 25}" ng-click="params.count(25)" class="btn btn-default">25</button>
                    <button type="button" ng-class="{'active':params.count() == 50}" ng-click="params.count(50)" class="btn btn-default">50</button>
                    <button type="button" ng-class="{'active':params.count() == 100}" ng-click="params.count(100)" class="btn btn-default">100</button>
                </div>
                </li>
            </ul>
        </script>
	</div>
</div>
<div class="row-fluid" ng-if="adminAccess && backlogProjectsList.length > 0">
	<div class="panel panel-warning dashboard-widget" >
		<div class="panel-heading">Staffing Deficits: Backlog Projects
			<div class="pull-right  btn-group btn-group-sm dashboard-actions">
		  		<a class="btn btn-default" ng-mousedown="backlogDefToCSV.generate()" ng-href="{{backlogDefToCSV.link()}}" download="backlogDeficit.csv"> 
      				<div class="hidden-xs"><i class="fa fa-table"></i><span> Export to CSV</span></div>
      				<div class="visible-xs"><i class="fa fa-table"></i></div>
    	 		 </a>
    	 	</div>
		</div>
		<table ng-table="backlogRoleList" template-pagination="backlogDeficit/pager" 
		       class="table margin-top" export-backlog="backlogDefToCSV" >
			<thead>
				<th class="text-center sortable" ng-class="{
                    'sort-asc': backlogRoleList.isSortBy('title', 'asc'),
                    'sort-desc': backlogRoleList.isSortBy('title', 'desc')
                  }"
                  ng-click="backlogRoleList.sorting({'title' : backlogRoleList.isSortBy('title', 'asc') ? 'desc' : 'asc'})">
                  <div>Project</div>
                </th>
                <th class="text-center sortable" ng-class="{
                    'sort-asc': backlogRoleList.isSortBy('role', 'asc'),
                    'sort-desc': backlogRoleList.isSortBy('role', 'desc')
                  }"
                  ng-click="backlogRoleList.sorting({'role' : backlogRoleList.isSortBy('role', 'asc') ? 'desc' : 'asc'})">
                  <div>Role</div>
                </th>
                <th class="text-center sortable" ng-class="{
                    'sort-asc': backlogRoleList.isSortBy('hours', 'asc'),
                    'sort-desc': backlogRoleList.isSortBy('hours', 'desc')
                  }"
                  ng-click="backlogRoleList.sorting({'hours' : backlogRoleList.isSortBy('hours', 'asc') ? 'desc' : 'asc'})">
                  <div>Hours</div>
                </th>
                <th class="hidden-xs text-center sortable" ng-class="{
                    'sort-asc': backlogRoleList.isSortBy('startDate', 'asc'),
                    'sort-desc': backlogRoleList.isSortBy('startDate', 'desc')
                  }"
                  ng-click="backlogRoleList.sorting({'startDate' : backlogRoleList.isSortBy('startDate', 'asc') ? 'desc' : 'asc'})">
                  <div>Start Date</div>
                </th>
                <th class="hidden-xs text-center sortable" ng-class="{
                    'sort-asc': backlogRoleList.isSortBy('endDate', 'asc'),
                    'sort-desc': backlogRoleList.isSortBy('endDate', 'desc')
                  }"
                  ng-click="backlogRoleList.sorting({'endDate' : backlogRoleList.isSortBy('endDate', 'asc') ? 'desc' : 'asc'})">
                  <div>End Date</div>
                </th>
                <th class="visible-xs text-center sortable" ng-class="{
                    'sort-asc': backlogRoleList.isSortBy('startDate', 'asc'),
                    'sort-desc': backlogRoleList.isSortBy('startDate', 'desc')
                  }"
                  ng-click="backlogRoleList.sorting({'startDate' : backlogRoleList.isSortBy('startDate', 'asc') ? 'desc' : 'asc'})">
                  <div>Dates</div>
                </th>
			</thead>
			<tr ng-repeat="backlogRole in $data">
				<td sortable="'title'">
					<a href="#{{backlogRole.projectResource}}">{{backlogRole.title}}</a></td>
				<td sortable="'role'">{{backlogRole.role}}</td>
				<td sortable="'hours'">
					{{backlogRole.hours}}</td>
				<td class="hidden-xs" data-title="'Start Date'" sortable="'startDate'">
					{{backlogRole.startDate}}</td>
				<td class="hidden-xs" data-title="'End Date'" sortable="'endDate'">
					{{backlogRole.endDate}}</td>
				<td class="visible-xs">
                    <small>{{backlogRole.startDate | date:'shortDate'}}</small>
                    <span ng-show="backlogRole.endDate">-<br><small>{{backlogRole.endDate | date:'shortDate'}}</small></span>
                    <span ng-hide="backlogRole.endDate">- <small>N/A</small></span>
                </td>
			</tr>

		</table>

		<script type="text/ng-template" id="backlogDeficit/pager">
            <ul class="pager ng-cloak">
              <li ng-repeat="page in pages"
                    ng-class="{'disabled': !page.active, 'previous': page.type == 'prev', 'next': page.type == 'next'}"
                    ng-show="page.type == 'prev' || page.type == 'next'" ng-switch="page.type">
                <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo; Previous</a>
                <a ng-switch-when="next" ng-click="params.page(page.number)" href="">Next &raquo;</a>
              </li>
                <li>
                <div class="btn-group" ng-show="page.type == 'prev' || page.type == 'next'">
                    <button type="button" ng-class="{'active':params.count() == 10}" ng-click="params.count(10)" class="btn btn-default">10</button>
                    <button type="button" ng-class="{'active':params.count() == 25}" ng-click="params.count(25)" class="btn btn-default">25</button>
                    <button type="button" ng-class="{'active':params.count() == 50}" ng-click="params.count(50)" class="btn btn-default">50</button>
                    <button type="button" ng-class="{'active':params.count() == 100}" ng-click="params.count(100)" class="btn btn-default">100</button>
                </div>
                </li>
            </ul>
        </script>
	</div>
</div>

<div id="dashboard-widgets" class="row">
		<div class="row-fluid">
			<div ng-if="hasActiveProjects"
				class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
				<div class="panel panel-default dashboard-widget">
					<div class="panel-heading">
						<a href="#{{me.about}}">My Active Projects</a>
					</div>
					<div class="panel-body">
						<ul ng-repea>
							<li ng-repeat="project in myActiveProjects"><a
								ng-href="#{{project.resource}}">{{project.name}}</a></li>
						</ul>
					</div>
				</div>
				<div class="panel panel-default dashboard-widget">
					<div class="panel-heading">
						<a href="#{{me.about}}">Log Hours</a>
						<div class="pull-right  btn-group btn-group-sm dashboard-actions">
							<button class="btn btn-default" data-toggle="collapse"
								data-target="#logHours">
								<div>
									<i class="fa fa-plus-square"></i>
								</div>
							</button>
						</div>
					</div>
					<div id="logHours" class="panel-body collapse out">
						<div class="row">
							<div class="col-xs-4">
								<label class="control-label">Person: </label> <span
									style="white-space: nowrap; overflow: hidden;">{{me.name}}</span>
							</div>
							<div class="col-xs-8">
								<label class="required-label control-label" for="project">Project:</label>
								<select name="project" id="project"
									class="col-xs-12 form-control"
									ng-model="newHoursRecord.project.resource" ng-required="true"
									ng-options="p.resource as p.name for p in activeAndBacklogProjects">
								</select>
							</div>
						</div>
						<br />
						<div class="row">
							<div class="col-xs-6">
								<label class="required-label  control-label" for="hours">Hours:</label>
								<input id="hours" name="hours" class="form-control"
									type="number" ng-model="newHoursRecord.hours"
									ng-required="true" />
							</div>
							<div class="col-xs-6">
								<label class="required-label control-label" for="date">Date:</label>
								<input id="date" name="date" class="form-control datepicker"
									type="text" ng-model="newHoursRecord.date" todayBtn="true"
									data-provide="datepicker" data-date-format="yyyy-mm-dd"
									ng-required="true" />
							</div>
						</div>
						<br />
						<div class="row">
							<div class="col-xs-12">
								<label class="required-label  control-label" for="hours">Description:</label>
								<textarea id="hours" name="hours" rows="5" class="form-control"
									ng-model="newHoursRecord.description" ng-required="true"></textarea>
							</div>
						</div>
						<br />
						<div class="row">
							<div class="col-xs-12">
								<input type="submit" class="btn" value="Add"
									ng-click="addHours()">
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
				<div class="panel panel-default dashboard-widget">
					<div class="panel-heading">
						<a href="#projects?filter=active">Active Projects</a>
						<div class="pull-right  btn-group btn-group-sm dashboard-actions">
							<button class="btn btn-default" ng-click="createProject()">
								<div>
									<i class="fa fa-plus-square"></i>
								</div>
							</button>
						</div>
					</div>
					<div class="panel-body">
						<div class="dashboard-box big-text"
							ng-click="showActiveProjects()">{{projectCount}}</div>
					</div>
				</div>
			</div>

			<div class="col-xs-12 col-sm-12 col-md-4 col-lg-6">
				<div class="panel panel-default dashboard-widget">
					<div class="panel-heading">
						<a href="#/people/?filter=available">Available People</a>
					</div>
					<div class="panel-body">
						<div class="dashboard-box peopleList three-rows">
							<div class="row">
								<div class="col-xs-4 col-sm-3" style="min-width: 100px"
									ng-repeat="person in availablePeople">
									<a href="#{{person.resource}}"> <img alt="{{person.name}}"
										title="{{person.name}}" ng-src="{{person.thumbnail}}" />
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="row-fluid">
	<div>
		<div class="panel panel-default dashboard-widget">
			<div class="panel-heading">
				Quick View
				<div class="pull-right btn-group btn-group-sm dashboard-actions"
					style="top: -7px;">
					<select class="form-control" ng-model="summarySwitcher">
						<option value="projects">Projects View</option>
						<option value="people">People View</option>
					</select>
				</div>
			</div>
			<div class="panel-body">
				<div class="row graph" ng-show="summarySwitcher == 'projects'">
					<div id="projectsSummaryGraph" class="col-xs-12">
						<div class="row">
							<div class="col-xs-2">{{getMonthName(startDate.getMonth())}}</div>
							<div class="col-xs-2">{{getMonthName(startDate.getMonth()+1)}}</div>
							<div class="col-xs-2">{{getMonthName(startDate.getMonth()+2)}}</div>
							<div class="col-xs-2">{{getMonthName(startDate.getMonth()+3)}}</div>
							<div class="col-xs-2">{{getMonthName(startDate.getMonth()+4)}}</div>
							<div class="col-xs-2">{{getMonthName(startDate.getMonth()+5)}}</div>
						</div>
						<div class="row" ng-repeat="project in qvProjects">
							<div>
								<a href="#{{project.resource}}">{{project.name}}</a>
							</div>
							<div class="col-xs-2"
								ng-class="{active: inMonth(project, startDate.getMonth(), startDate.getFullYear())}"></div>
							<div class="col-xs-2"
								ng-class="{active: inMonth(project, startDate.getMonth()+1, startDate.getFullYear())}"></div>
							<div class="col-xs-2"
								ng-class="{active: inMonth(project, startDate.getMonth()+2, startDate.getFullYear())}"></div>
							<div class="col-xs-2"
								ng-class="{active: inMonth(project, startDate.getMonth()+3, startDate.getFullYear())}"></div>
							<div class="col-xs-2"
								ng-class="{active: inMonth(project, startDate.getMonth()+4, startDate.getFullYear())}"></div>
							<div class="col-xs-2"
								ng-class="{active: inMonth(project, startDate.getMonth()+5, startDate.getFullYear())}"></div>
						</div>
					</div>
				</div>
				<div class="row graph" ng-show="summarySwitcher == 'people'">
					<div id="peopleSummaryGraph" class="col-xs-12">
						<div class="row">
							<div class="col-xs-1"></div>
							<div class="col-xs-11">
								<div class="row">
									<div class="col-xs-2">{{getMonthName(startDate.getMonth())}}</div>
									<div class="col-xs-2">{{getMonthName(startDate.getMonth()+1)}}</div>
									<div class="col-xs-2">{{getMonthName(startDate.getMonth()+2)}}</div>
									<div class="col-xs-2">{{getMonthName(startDate.getMonth()+3)}}</div>
									<div class="col-xs-2">{{getMonthName(startDate.getMonth()+4)}}</div>
									<div class="col-xs-2">{{getMonthName(startDate.getMonth()+5)}}</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row peopleList" ng-repeat="person in qvPeople"
						ng-show="qvPeople">
						<div class="col-xs-1">
							<div style="float: left position:absolute">
								<a href="#{{person.about}}">{{person.givenName}}</a>
							</div>
							<img title="{{person.name}}" class="profileImage"
								ng-src="{{person.thumbnail}}" />
						</div>
						<div class="col-xs-11">
							<div class="row"
								ng-repeat="project in qvPeopleProjects[person.about] track by $index">
								<div>
									<a href="#{{project.resource}}">{{project.name}}</a>
								</div>
								<div class="col-xs-2"
									ng-class="{active: isPersonActiveInMonth(project, person, startDate.getMonth(), startDate.getFullYear())}"></div>
								<div class="col-xs-2"
									ng-class="{active: isPersonActiveInMonth(project, person, startDate.getMonth()+1, startDate.getFullYear())}"></div>
								<div class="col-xs-2"
									ng-class="{active: isPersonActiveInMonth(project, person, startDate.getMonth()+2, startDate.getFullYear())}"></div>
								<div class="col-xs-2"
									ng-class="{active: isPersonActiveInMonth(project, person, startDate.getMonth()+3, startDate.getFullYear())}"></div>
								<div class="col-xs-2"
									ng-class="{active: isPersonActiveInMonth(project, person, startDate.getMonth()+4, startDate.getFullYear())}"></div>
								<div class="col-xs-2"
									ng-class="{active: isPersonActiveInMonth(project, person, startDate.getMonth()+5, startDate.getFullYear())}"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

</div>
</div>