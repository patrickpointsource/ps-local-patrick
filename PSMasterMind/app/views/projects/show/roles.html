<div ng-form="rolesForm" ng-controller="RolesCtrl">
	<section class="well">
        <h3>Add Role</h3>

        <div class="row">
            <div class="col-xs-4 form-group">
                <label class="required-label" for="role">Role:</label>
                <select id="role" class="col-xs-12 form-control" ng-model="newRole.type.resource"
                        ng-options="m.resource as m.title for m in roleTypes">

                </select>
            </div>
            <div class="col-xs-4 form-group">
                <label class="required-label" for="roleStartDate">Start Date:</label>
                <input id="roleStartDate" class="form-control datepicker" type="text" ng-model="newRole.startDate"
                        data-provide="datepicker" data-date-format="yyyy-mm-dd" ng-required="true">
            </div>
            <div class="col-xs-4 form-group">
                <label for="roleEndDate">End Date:</label>
                <input id="roleEndDate" class="form-control datepicker" type="text" ng-model="newRole.endDate"
                        data-provide="datepicker" data-date-format="yyyy-mm-dd">
            </div>
        </div>

        <!--
          TODO: Convert to Angular UI tabs component.

          Currently we can't do this because of a bug in Angular UI Bootstrap which prevents nested tabs.

          There is an open ticket under:
          https://github.com/angular-ui/bootstrap/issues/783
          -->

        <div class="row">
            <div class="tab-panes tabs-left col-xs-6">
                <ul class="nav nav-tabs">
                    <li class="active">
                        <a ng-click="changeToHourlyRate()"
                                data-target="#hourlyControls"
                                data-toggle="tab">Hourly</a>
                    </li>
                    <li>
                        <a ng-click="changeToWeeklyRate()"
                                data-target="#weeklyControls"
                                data-toggle="tab">Weekly</a>
                    </li>
                    <li>
                        <a ng-click="changeToMonthlyRate()" data-target="#monthlyControls" data-toggle="tab">Monthly</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div id="hourlyControls" class="tab-pane active">
                        <div class="row">
                            <div class="col-xs-12 form-group">
                                <label for="hourlyHourlyRate">Hourly Rate:</label>
                                <input id="hourlyHourlyRate" class="form-control"
                                        placeholder="Enter Hourly Rate"
                                        type="number" min="0" ng-model="newRole.rate.amount">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 form-group">
                                <label for="hourlyHours">Hours/Month:</label>
                                <input id="hourlyHours" class="form-control" placeholder="Enter Hours per Month"
                                        type="number" required min="0" max="220" ng-model="newRole.rate.hours">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 form-group">
                                <label>Utilization:</label>
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox" ng-model="newRole.rate.fullyUtilized">
                                        100% Utilized
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="weeklyControls" class="tab-pane">
                        <div class="row">
                            <div class="col-xs-12 form-group">
                                <label for="weeklyHourlyRate">Hourly Rate:</label>
                                <input id="weeklyHourlyRate" class="form-control"
                                        placeholder="Enter Hourly Rate" min="0" type="number"
                                        ng-model="newRole.rate.amount">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 form-group">
                                <label for="weeklyHours">Hours/Week:</label>
                                <input id="weeklyHours" class="form-control" placeholder="Enter Hours per Week"
                                        type="number" required min="0" max="50" ng-model="newRole.rate.hours">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 form-group">
                                <label>Utilization:</label>
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox" ng-model="newRole.rate.fullyUtilized">
                                        100% Utilized
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="monthlyControls" class="tab-pane">
                        <div class="row">
                            <div class="col-xs-12 form-group">
                                <label for="monthlyRate">Monthly Rate:</label>
                                <input id="monthlyRate" class="form-control" placeholder="Margin" type="number"
                                        ng-model="newRole.rate.amount">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xs-6 form-group">
                <label>Shoring:</label>
                <div class="radio">
                  <label>
                      <input type="radio" value="on" ng-model="newRole.shore">Onshore
                  </label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" value="off" ng-model="newRole.shore">Offshore
                    </label>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-12">
                <input type="submit" class="btn" value="Add Role" ng-click="add()"
                        ng-disabled="!rolesForm.$valid">
            </div>
        </div>
    </section>

    <h3>Current Roles</h3>
	<button ng-click="roleTableParams.reload()" class="btn btn-default">Reload</button>
    <div class="row">
        <div class="col-xs-12">
            <table class="table" ng-table="roleTableParams" template-pagination="custom/pager">
                <tr ng-repeat="role in $data">
                    <td data-title="'Role'">{{role.type.resource}}</td>
                    <td data-title="'100%'"><i class="fa fa-check" ng-show="role.rate.isFullyUtilized()"></i></td>
                    <td data-title="'H/M'">{{role.rate.hoursPerMonth()}}</td>
                    <td data-title="'Start Date'">{{role.startDate | date:'longDate'}}</td>
                    <td data-title="'End Date'">{{role.endDate | date:'longDate'}}</td>
                    <td><button class="btn btn-default" ng-click="remove(role)"><i class="fa fa-trash-o"></i></button></td>
                </tr>
            </table>
            <script type="text/ng-template" id="custom/pager">
                <ul class="pager ng-cloak">
                    <li ng-repeat="page in pages"
                            ng-class="{'disabled': !page.active, 'previous': page.type == 'prev', 'next': page.type == 'next'}"
                            ng-show="page.type == 'prev' || page.type == 'next'" ng-switch="page.type">
                        <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo; Previous</a>
                        <a ng-switch-when="next" ng-click="params.page(page.number)" href="">Next &raquo;</a>
                    </li>
                    <li>
                        <div class="btn-group" ng-show="page.type == 'prev' || page.type == 'next'">
                            <button type="button" ng-class="{'active':params.count() == 10}" ng-click="params.count(10)" class="btn btn-default">10</button>
                            <button type="button" ng-class="{'active':params.count() == 25}" ng-click="params.count(25)" class="btn btn-default">25</button>
                            <button type="button" ng-class="{'active':params.count() == 50}" ng-click="params.count(50)" class="btn btn-default">50</button>
                            <button type="button" ng-class="{'active':params.count() == 100}" ng-click="params.count(100)" class="btn btn-default">100</button>
                        </div>
                    </li>
                </ul>
            </script>
        </div>
    </div>
</div>