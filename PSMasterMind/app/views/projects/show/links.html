<div ng-controller="LinksCtrl">
  <div class="row">
    <div class="col-xs-2"><h3>Links</h3></div>
    <div class="actions col-xs-10 pageActions">
      <button type="button" ng-click="toggleNewLink()"
          class="btn btn-default pull-right" data-toggle="collapse" data-target="#newLinkDialog">
        <i class="fa fa-plus-square"></i> <span>Add Links</span>
      </button>
      <button class="btn btn-default" ng-click="launchDropboxChooser()">
        <i class="fa fa-dropbox"></i> <span>Dropbox</span>
      </button>
    </div>
  </div>

  <section id="newLinkDialog" class="well collapse out">
    <form name="addLinkForm" novalidate>
      <div class="row">
        <div class="col-xs-12 form-group">
          <label class="control-label" for="newLinkURL">URL:</label>
          <p class="help-block" ng-show="!addLinkForm.url.$pristine && addLinkForm.url.$invalid">
            <span class="text-danger">You must provide a valid URL</span>
          </p>
          <input class="col-xs-12 form-control" type="url" name="url" id="newLinkURL" ng-model="newLink.url" required>
        </div>
      </div>
      <div class="row"><div class="col-xs-12"></div></div>
      <div class="row">
        <div class="col-xs-12 form-group">
          <label class="control-label" for="newLinkLabel">Label:</label>
          <p class="help-block" ng-show="!addLinkForm.label.$pristine && addLinkForm.label.$invalid">
            <span class="text-danger">Label is required</span>
          </p>
          <input class="col-xs-12 form-control" id="newLinkLabel" name="label" ng-model="newLink.label" required>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <input type="submit" class="btn" value="Add" ng-click="addLink()"
              ng-disabled="addLinkForm.$invalid">
          <input type="submit" class="btn" value="Cancel" ng-click="cancelAddLink()">
        </div>
      </div>
    </form>
  </section>

  <div class="row">
    <div class="col-xs-12">
      <table ng-table="linksTableParams" class="table">
        <tbody ng-repeat="link in $data">
          <tr>
            <td data-title="'Link'" sortable="'label'">
              <img ng-if="link.icon" ng-src="{{link.icon}}" style="width:24px;height:24px"/>
              <a ng-href="{{link.url}}" target="_blank" ng-bind="link.label"></a>
            </td>
            <td class="actionsCell">
              <button class="btn btn-default" ng-click="triggerEditLink(link, $index)">
                    <i class="fa fa-pencil"></i>
                </button>
              <button class="btn btn-default" ng-click="deleteLink(link)">
                <i class="fa fa-trash-o"></i>
              </button>
            </td>
          </tr>
          <tr ng-if="editLinkIndex===$index">
            <td>
              <section class="well" id="editLinkDialog-{{$index}}">
                <form name="editLinkForm" novalidate>
                  <div class="row">
                    <div class="col-xs-12 form-group">
                      <label class="control-label" for="editLinkURL">URL:</label>
                      <p class="help-block" ng-show="!editLinkForm.url.$pristine && editLinkForm.url.$invalid">
                        <span class="text-danger">You must provide a valid URL</span>
                      </p>
                      <input class="col-xs-12 form-control" type="url" name="url" id="editLinkURL" ng-model="editLink.url" required>
                    </div>
                  </div>
                  <div class="row"><div class="col-xs-12"></div></div>
                  <div class="row">
                    <div class="col-xs-12 form-group">
                      <label class="control-label" for="editLinkLabel">Label:</label>
                      <p class="help-block" ng-show="!editLinkForm.label.$pristine && editLinkForm.label.$invalid">
                        <span class="text-danger">Label is required</span>
                      </p>
                      <input class="col-xs-12 form-control" id="editLinkLabel" name="label" ng-model="editLink.label" required>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-xs-12">
                      <input type="submit" class="btn" value="Save" ng-click="saveEditLink(link)"
                          ng-disabled="editLinkForm.$invalid">
                      <input type="submit" class="btn" value="Cancel" ng-click="cancelEditLink(link)">
                    </div>
                  </div>
                </form>
              </section>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>